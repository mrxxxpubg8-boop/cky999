<!DOCTYPE html>  <html lang="zh">  
<head>  
<meta charset="UTF-8">  
<title>杀组28 @SZ28BOT</title>  
<style>  
body { font-family: Arial, sans-serif; text-align:center; background:#f8f8f8; margin:0; padding:0; }  
h1 { margin-top:20px; font-size:28px; font-weight:bold; }  
button { padding:5px 10px; cursor:pointer; font-size:16px; }  
#passwordOverlay {  
    position:fixed; top:0; left:0; width:100%; height:100%;  
    background:#f8f8f8; display:flex; justify-content:center; align-items:center;  
    flex-direction:column; z-index:9999;  
}  
#passwordOverlay input { padding:10px; font-size:18px; }  
#passwordOverlay button { margin-top:10px; padding:8px 16px; font-size:16px; }  
#passwordError { color:red; margin-top:10px; }  
#mainControls { display:flex; justify-content:center; gap:10px; margin-bottom:20px; flex-wrap:wrap; }  
#algorithmSelect { font-size:16px; padding:5px; }  
#infoBoxes { display:flex; justify-content:center; gap:20px; margin-bottom:20px; }  
.infoBox {  
    background:#e0f0ff; padding:10px 20px; border-radius:10px; font-size:20px; font-weight:bold;  
    display:flex; align-items:center; gap:5px;  
}  
table { border-collapse: collapse; margin:auto; width:90%; background:#fff; }  
th, td { border:1px solid #ccc; padding:5px; text-align:center; font-weight:bold; }  
th { background:#eee; }  
.correct { color: green; }  
.wrong { color: red; }  
footer {   
    margin-top:10px; font-size:42px; font-weight:bold; color:#fff;  
    background: linear-gradient(to right, #1e3c72, #2a5298); padding:12px 0; border-radius:12px;  
}  
#versionInfo { margin-top:5px; font-size:18px; color:#fff; }  
</style>  
</head>  
<body>  <!-- 密码覆盖层 -->  <div id="passwordOverlay">  
    <h2>请输入访问密码</h2>  
    <input type="password" id="passwordInput" placeholder="密码">  
    <button onclick="checkPassword()">提交</button>  
    <p id="passwordError"></p>  
</div>  <!-- 主内容 -->  <div id="mainContent" style="display:none;">  
    <h1>杀组28 @SZ28BOT</h1>  
    <div id="mainControls">  
        <select id="algorithmSelect">  
            <option value="1">算法1</option>  
            <option value="2">算法2</option>  
        </select>  
        <button onclick="loadData()">刷新数据</button>  
    </div>  <div id="infoBoxes">  
    <div class="infoBox" id="nextPredBox"><span id="nextPred">加载中...</span></div>  
    <div class="infoBox" id="winRateBox"><span id="winRate">加载中...</span></div>  
</div>  

<h2>最近 20 期预测结果</h2>  
<table id="historyTable">  
    <tr><th>期号</th><th>预测</th><th>开奖和值</th><th>结果</th></tr>  
</table>  

<footer>  
    BY CKY  
    <div id="versionInfo">杀组28 版本 v1.1.3</div>  
</footer>

</div>  <script>  
// ==== 密码验证 ====  
const passwordList = ["sz28test1","sz28test2","sz28test3","sz28test4","sz28test5"];  
function checkPassword() {  
    const pw = document.getElementById("passwordInput").value;  
    if(passwordList.includes(pw)){  
        localStorage.setItem("sz28_pass","true"); // 保存已验证状态  
        document.getElementById("passwordOverlay").style.display="none";  
        document.getElementById("mainContent").style.display="block";  
        loadData();  
    } else {  
        document.getElementById("passwordError").innerText="密码错误，请重试";  
    }  
}  
  
// 页面加载后检查本地存储  
window.onload = function(){  
    if(localStorage.getItem("sz28_pass") === "true"){  
        document.getElementById("passwordOverlay").style.display="none";  
        document.getElementById("mainContent").style.display="block";  
        loadData();  
    }  
}  
  
// ==== 工具函数 ====  
function sum(arr){ return arr.reduce((a,b)=>a+b,0); }  
function checkWin(pred, total){  
    let size = total>=14?'大':'小';  
    let parity = total%2===1?'单':'双';  
    let combination = size+parity;  
    if(pred==='杀小单' && combination!=='小单') return '✅';  
    if(pred==='杀小双' && combination!=='小双') return '✅';  
    if(pred==='杀大单' && combination!=='大单') return '✅';  
    if(pred==='杀大双' && combination!=='大双') return '✅';  
    return '❌';  
}  
  
// 算法函数  
function calcAlgorithm1(last3_nums){  
    let a = (sum(last3_nums[2])+last3_nums[2][0])/0.28 +  
            (sum(last3_nums[1])+last3_nums[1][0])/0.28 +  
            (sum(last3_nums[0])+last3_nums[0][0])/0.28;  
    let b = Math.sqrt(a);  
    let c = b / 3;  
    let decimal = c.toFixed(3).split('.')[1];  
    let digitSum = decimal.split('').reduce((s,d)=>s+parseInt(d),0);  
    if(digitSum < 14){  
        return digitSum%2===0 ? '杀大双':'杀大单';  
    } else {  
        return digitSum%2===0 ? '杀小双':'杀小单';  
    }  
}  
function calcAlgorithm2(last3_nums){  
    let a = (sum(last3_nums[2])+last3_nums[2][0])/4 +  
            (sum(last3_nums[1])+last3_nums[1][0])/4 +  
            (sum(last3_nums[0])+last3_nums[0][0])/4;  
    let b = Math.sqrt(a);  
    let c = b / 28;  
    let decimal = c.toFixed(3).split('.')[1];  
    let digitSum = decimal.split('').reduce((s,d)=>s+parseInt(d),0);  
    if(digitSum < 14){  
        return digitSum%2===0 ? '杀小双':'杀小单';  
    } else {  
        return digitSum%2===0 ? '杀大双':'杀大单';  
    }  
}  
  
// ==== 获取 JSON ====  
async function fetchJSON(url){  
    try{  
        const resp = await fetch(url);  
        return await resp.json();  
    } catch(e){ console.error(e); return null; }  
}  
  
// ==== 加载数据 ====  
async function loadData(){  
    const latestData = await fetchJSON('https://pc28.help/kj.json');  
    if(!latestData || !latestData.data){ alert("获取数据失败"); return; }  
    const latestQihao = parseInt(latestData.data[0].qihao);  
    const recordDict = {};  
    for(let q=latestQihao-22;q<=latestQihao;q++){  
        const rec = await fetchJSON(`https://pc28.help/qihao/${q}`);  
        if(rec && rec.data){  
            const nums = rec.data[0].opennum.replace(/,/g,'+').split('+').map(Number).slice(0,3);  
            if(nums.length>=3) recordDict[q] = nums;  
        }  
    }  
  
    const sortedQihao = Object.keys(recordDict).map(Number).sort((a,b)=>b-a);  
    const historyTable = document.getElementById('historyTable');  
    historyTable.innerHTML='<tr><th>期号</th><th>预测</th><th>开奖和值</th><th>结果</th></tr>';  
  
    let winCount = 0;  
    const testQihaoList = sortedQihao.slice(0,20);  
    const selectedAlgo = document.getElementById("algorithmSelect").value;  
  
    for(let curQihao of testQihaoList){  
        const prevQihaos = sortedQihao.filter(q=>q<curQihao).sort((a,b)=>b-a);  
        if(prevQihaos.length<3) continue;  
        const last3_nums = prevQihaos.slice(0,3).map(q=>recordDict[q]);  
        let pred = selectedAlgo==='1'?calcAlgorithm1(last3_nums):calcAlgorithm2(last3_nums);  
        let total = sum(recordDict[curQihao]);  
        if(total<10) total = '0'+total;  
        const res = checkWin(pred,total);  
        if(res==='✅') winCount++;  
        const tr = document.createElement('tr');  
        tr.innerHTML=`<td>${curQihao}</td><td>${pred}</td><td>${total}</td><td class="${res==='✅'?'correct':'wrong'}">${res}</td>`;  
        historyTable.appendChild(tr);  
    }  
  
    document.getElementById('winRate').innerText = `历史胜率: ${(winCount/testQihaoList.length*100).toFixed(1)}%`;  
    const latestThree = sortedQihao.slice(0,3).map(q=>recordDict[q]);  
    const nextPred = selectedAlgo==='1'?calcAlgorithm1(latestThree):calcAlgorithm2(latestThree);  
    document.getElementById('nextPred').innerText=`最新${latestQihao+1}期预测: ${nextPred}`;  
}  
</script>  </body>  
</html>
